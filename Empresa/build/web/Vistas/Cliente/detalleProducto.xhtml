<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:a="http://xmlns.jcp.org/jsf/passthrough">
    <h:head>
        <title>Facelet Title</title>
        <style type="text/css">
            .value {
                font-weight: bold;
            }

            body .ui-carousel {
                margin-bottom: 20px;
                border: none;
            }
            body .ui-datagrid-no-border .ui-datagrid-content {
                border: none;
            }
            body .ui-datagrid .ui-datagrid-header{
                border: none;
                background-color:#F7F7F7;
            }
            .media{
                border-top: 1px solid #EFEFEF;
                padding-top: 20px;
            }
            .media img{
                margin-right: 20px;
            }
            .media .nombre{
                color: #000000;
                font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";
                margin-bottom: 0px;
                font-size: 1rem;
            }
            .media .nombre span{
                font-size: 12px;
                color: #464646;
                margin-left: 10px;
            }
            .media .comentario{
                margin-top: 10px;
            }
            h3{text-align: center;}
            span{text-align: center;}
            .progress{
                height: 0.5rem;
                margin-top: 22px;
            }
            .centrar{
                text-align: center;
            }


            body .ui-carousel .ui-carousel-header{
                border: none;
                background: #ffffff;
                font-weight: bold;
            }
            body .ui-carousel .ui-carousel-viewport{
                border: none;
            }
            body .ui-carousel .ui-carousel-viewport .ui-carousel-item{
                border: 1px solid #f3f3f3;
            }
            body .ui-carousel .ui-carousel-header .ui-carousel-header-title{
                font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";
                font-size: 1.5rem;
                font-weight: 300;
                line-height: 1.2;
            }
            body .ui-carousel .ui-carousel-viewport .ui-carousel-item{
                margin: 15px;
                border-radius: 5px;
            }

            body .ui-carousel .ui-carousel-viewport .ui-carousel-item:hover{
                box-shadow: 0px 1px 12px -1px rgba(0,0,0,0.40);
            }
            .ui-layout-unit .ui-layout-unit-content::-webkit-scrollbar {
                width: 5px;
            }
            .ui-layout-unit .ui-layout-unit-content::-webkit-scrollbar-thumb {
                background: #ECE8E8;
                border-radius: 5px;
            }
            body .ui-layout-unit {
                border: none;
            }
        </style>

    </h:head>
    <h:body>
        <div class="container mt-5 mb-0 pb-0">
            <!--SECCIÓN DE IMAGEN DEL PRODUCTO-->
            <div class="row mb-5">
                <div class="col-md-8 text-center">
                    <div class="">
                        <div class="col-md-10 d-flex justify-content-center">
                            <div class="col-md-11">
                                <h:graphicImage value="/Imagenes/Productos/#{clienteController.productoSeleccionado.id}.png" class="img-fluid" />
                            </div>
                        </div>
                    </div>
                </div>
                <!--SECCIÓN DE INFORMACION DE PRODUCTO-->
                <div class="col-md-4 mb-0 pb-0">
                    <div class="card">
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="col-md-12 m-0 p-0">
                                        <h5 class="card-title display-4" style="font-size: 1.6rem"><b>#{clienteController.productoSeleccionado.nombre}</b></h5>
                                    </div>
                                    <div class="col-md-12 m-0 p-0">
                                        <div class="row ml-1 mt-0">
                                            <p:rating class="mt-0 pt-0 mr-2"  readonly="true" value="#{comentarioController.valoracionProducto}"/> 
                                            <label>#{comentarioController.comentariosDeProducto.size()} Opiniones</label>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-md-12 mt-0">

                                    <h:outputText rendered="#{clienteController.productoSeleccionado.promocion == null}" value="#{clienteController.productoSeleccionado.precio}" style="font-size: 3rem" class="display-4 text-danger">
                                        <f:convertNumber currencySymbol="$" groupingUsed="true" maxFractionDigits="0" type="currency" locale="es_CO" />
                                    </h:outputText>
                                    <!--MUESTRA SI HAY PROMOCIONES-->
                                    <div>
                                        <strike>
                                            <h:outputText rendered="#{clienteController.productoSeleccionado.promocion != null}" value="#{clienteController.productoSeleccionado.precio}" style="font-size: 1rem" class="display-4 text-dark">
                                                <f:convertNumber currencySymbol="$" groupingUsed="true" maxFractionDigits="0" type="currency" locale="es_CO" />
                                            </h:outputText>
                                        </strike>
                                    </div>
                                    <div class="row d-flex justify-content-center">
                                        <h:outputText rendered="#{clienteController.productoSeleccionado.promocion != null}" value="#{clienteController.productoSeleccionado.promocion.preciopromocion}" style="font-size: 3rem" class="display-4 text-danger mr-1">
                                            <f:convertNumber currencySymbol="$" groupingUsed="true" maxFractionDigits="0" type="currency" locale="es_CO" />

                                        </h:outputText >
                                        <h:outputText value="#{clienteController.productoSeleccionado.promocion.descuento}% OFF" rendered="#{clienteController.productoSeleccionado.promocion != null}" style="font-size: 1rem" class="text-success"/>
                                    </div>

                                </div>
                                <div class="col-md-12 mt-1">
                                    <label class="lead mb-0 pb-2" style="font-size: 0.7rem">
                                        <span class="fa fa-tags fa-lg mr-2"></span>
                                        <label class="mb-0" style="font-size: 1rem">Marca <b>#{clienteController.productoSeleccionado.marca}</b></label>
                                    </label>
                                </div>
                                <div class="col-md-12 mt-1">
                                    <label class="lead" style="font-size: 0.7rem">
                                        <span class="fa fa-paint-brush fa-lg mr-2"></span>
                                        <label class="mb-0 p-0" style="font-size: 1rem">Color <b>#{clienteController.productoSeleccionado.color}</b></label>
                                    </label>
                                </div>

                                <div class="text-center col-md-12 mt-2">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <h:commandButton value="Comprar Ahora" action="#{ventaController.registrarVentaDeUnProducto(clienteController.productoSeleccionado)}" class="btn btn-primary w-75 mt-2"/>
                                        </div>
                                        <div class="col-md-12">
                                            <h:commandButton value="Agregar al carrito" action="#{cotizacionController.agregarProductoACotizacion(clienteController.productoSeleccionado)}" class="btn btn-success w-75 mt-2"/>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-4 col-md-12">
                                    <p><span class="fa fa-tag mr-2"> </span>  Vendido por: <b>TechStore</b></p>
                                    <p><span class="fa fa-truck mr-2"> </span>  Costo de envio: <b>A calcular</b></p>
                                    <p><span class="fa fa-check-circle mr-2"> </span>  Garantia del producto: <b>#{clienteController.productoSeleccionado.garantia}</b></p>
                                    <div><p>Veces comprado</p></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!--PRODUCTOS DE RELACIONADOS-->
        </div>
        <div class="container mt-0 pt-0">
            <div class="row">
                <div class="col-md-8">
                    <p:carousel value="#{productoController.productosRelacionados}" headerText="Más productos relacionados" var="prorel" responsive="true" easing="easeOutBounce">
                        <div class="d-flex justify-content-center">
                            <div class="col-md-8 d-flex justify-content-center">
                                <h:graphicImage value="/Imagenes/Productos/#{prorel.id}.png" class="" alt="Imagen de producto" style="min-height: 90px;max-height: 90px; max-width: 90px"/>
                            </div>
                        </div>
                        <div class="card-body text-center">
                            <h5 class="card-title font-weight-bold" style="font-size: 1rem">#{prorel.nombre}</h5>
                            <h:outputText style="font-size: 1rem" class="display-4 text-danger font-weight-bold" value="#{prorel.precio}" >
                                <f:convertNumber currencySymbol="$" groupingUsed="true" maxFractionDigits="0" type="currency" locale="es_CO" />
                            </h:outputText>
                            <div class="mt-2">
                                <h:commandButton class="btn btn-outline-success" value="Ver más" action="#{clienteController.verDetalleProducto(prorel)}"/>
                            </div>
                        </div>

                    </p:carousel>
                </div>
            </div>
        </div>


        <div class="container mt-3">
            <div class="row">

                <!--Calificación-->
                <div class="col-md-12">
                    <div class="row">
                        <div class="container">
                            <div class="row">
                                <div class="col-md-2 mr-0 mt-2 text-center">
                                    <h:outputLabel class="centrar display-4 mb-1" style="font-size: 90px;" value="#{comentarioController.valoracionProductoDouble}"/>
                                    <p:rating class="centrar lead"  readonly="true" value="#{comentarioController.valoracionProducto}"/>
                                    <h:outputLabel class="lead" value="#{comentarioController.comentariosDeProducto.size()} puntuaciones"></h:outputLabel>
                                </div>

                                <div class="mr-0 mt-2 mt-md-0 pt-0 m-md-2 ml-5">
                                    <p class="lead m-0 p-0"> 5</p>
                                    <p class="lead m-0 p-0"> 4</p>
                                    <p class="lead m-0 p-0"> 3</p>
                                    <p class="lead m-0 p-0"> 2</p>
                                    <p class="lead m-0 p-0"> 1</p>
                                </div>

                                <!--Barras de valoración-->
                                <div class="col-8 col-md-2 ml-md-0 mt-4 pt-1 ml-3" style="text-align: left">

                                    <div class="progress" style="height: 0.5rem; margin-top: -8px;">
                                        <div class="progress-bar" role="progressbar" style="width: #{comentarioController.starFive}%; " aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>

                                    <div class="progress">
                                        <div class="progress-bar" role="progressbar" style="width: #{comentarioController.starFour}%; " aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                    <div class="progress">
                                        <div class="progress-bar" role="progressbar" style="width: #{comentarioController.starThree}%; " aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                    <div class="progress">
                                        <div class="progress-bar" role="progressbar" style="width: #{comentarioController.starTwo}%; " aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                    <div class="progress">
                                        <div class="progress-bar" role="progressbar" style="width: #{comentarioController.starOne}%; " aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>

                                </div>

                                <!--Formulario de comentario-->
                                <div class="col-md-7 text-center mt-2">

                                    <div class="form-group d-flex justify-content-end flex-wrap">
                                        <h:inputTextarea a:placeholder="Escribe un comentario..." value="#{comentarioController.comentario.descripcion}" class="form-control" style="max-height: 90px; min-height: 90px"/>
                                        <p class="lead mt-1" style="font-size: 0.95rem;">Califica este producto</p><p:rating  readonly="false" class="lead mr-auto" value="#{comentarioController.comentario.rating}"/>
                                        <h:commandButton value="Comentar"  action="#{comentarioController.guardarComentario(clienteController.productoSeleccionado)}" class="btn btn-primary mt-2" />
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!--Seccion de comentarios-->
                <div class="col-md-8">
                    <p:dataGrid columns="1" value="#{comentarioController.comentariosDeProducto}" emptyMessage="No hay comentarios aun" layout="grid" var="com" class="ui-datagrid-no-border">
                        <f:facet name="header">
                            <label class="display-4" style="font-size: 1.5rem">Opiniones del producto (#{comentarioController.comentariosDeProducto.size()})</label>
                        </f:facet>

                        <div class="media">
                            <h:graphicImage value="/Imagenes/FotosUsuario/#{com.cliente.id}.png" style="height: 64px; width: 64px" class="rounded-circle"/>
                            <div class="media-body">
                                <p class="nombre"><b>#{com.cliente.nombre} #{com.cliente.apellido}</b>
                                    <span>#{com.fecha}</span>
                                    <span><p:rating  readonly="true" value="#{com.rating}"/></span>
                                </p>
                                <p class="comentario">
                                    #{com.descripcion}
                                </p>
                            </div>
                        </div>

                    </p:dataGrid>
                </div>
            </div>
        </div>

    </h:body>
</html>

